import Mqtt from "../mqtt"
import Array from "array"
import Char from "char"
import {schedYield} from "sys/process"

let broker = Mqtt.new()

broker.initialize()
broker.onReceive((client, message) => {
    print("Message: " ++ message)
    void
})
broker.subscripe("#")
broker.start()

print("Running")

while(true) {
    broker.loop()

    schedYield()
    void
}
